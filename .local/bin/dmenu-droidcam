#! /bin/bash

# MENU="/usr/local/bin/dmenu"
# MENU="/usr/bin/rofi -dmenu -lines 3 -width 200"
DMENU="rofi -dmenu -lines 5 -i"

function audio_only() {
  droidcam-cli -a 192.168.100.2 4747
}

function video_only() {
  droidcam-cli 192.168.100.2 4747
}

function audio_video() {
  droidcam-cli -a -v 192.168.100.2 4747
}

function kill_droidcam() {
    pkill droidcam-cli
    exit
}

# OPTIONS=$(echo -e "Audio-only\nVideo-only\nAudio-Video" | $MENU -p "ï†« Translate")


function asktoend() {
    response=$(printf "No\\nYes" | $DMENU -i -p "droidcam still active. Kill droidcam?") &&
    [ "$response" = "Yes" ] &&  kill_droidcam
}

function pilih() {
    choice=$(printf "Audio-only\\nVideo-only\\nAudio-Video" | $DMENU -i -p "Select recording style:")
    case "$choice" in
        Audio-only) audio_only;;
        Video-only) video_only;;
        Audio-Video) audio_video;;
    esac
}

case $1 in
  Audio-only) audio_only ;;
  Video-only) video_only ;;
  Audio-Video) audio_video ;;
  *) ([ -n "$(pgrep droidcam-cli)" ] && asktoend && exit) || pilih ;;
esac
